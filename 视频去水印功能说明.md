# ğŸ¬ GLM è§†é¢‘å»æ°´å°åŠŸèƒ½å®ç°

## ğŸ¯ æ ¸å¿ƒå»æ°´å°å‚æ•°

### `label_watermark` å‚æ•°
- **0**: æ— æ°´å° (æ¨èè®¾ç½®)
- **1**: æœ‰æ°´å° (é»˜è®¤å®˜æ–¹è®¾ç½®)

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### 1. åŸºç¡€å»æ°´å°è¯·æ±‚ (çºµå‘9:16)
```bash
curl -X POST "http://localhost:8000/v1/videos/generations" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -d '{
    "model": "cogvideox",
    "prompt": "åšä¸ªçºµå‘åŠ¨ç”»",
    "label_watermark": 0,
    "image_url": "https://example.com/image.jpg",
    "options": {
      "generationPattern": 1,
      "resolution": 2,
      "fps": 60,
      "duration": 1,
      "ratioWidth": 608,
      "ratioHeight": 1080
    }
  }'
```

### 1.2 æ¨ªå‘è§†é¢‘è¯·æ±‚ (16:9)
```bash
curl -X POST "http://localhost:8000/v1/videos/generations" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -d '{
    "model": "cogvideox",
    "prompt": "åšä¸ªæ¨ªå‘åŠ¨ç”»",
    "label_watermark": 0,
    "image_url": "https://example.com/image.jpg",
    "options": {
      "generationPattern": 1,
      "resolution": 2,
      "fps": 60,
      "duration": 1,
      "ratioWidth": 1080,
      "ratioHeight": 608
    }
  }'
```

### 2. JavaScript è°ƒç”¨ç¤ºä¾‹
```javascript
const response = await axios.post('http://localhost:8000/v1/videos/generations', {
  model: "cogvideox",
  prompt: "åšä¸ªåŠ¨ç”»",
  label_watermark: 0, // å…³é”®å»æ°´å°å‚æ•°
  image_url: "https://example.com/image.jpg",
  options: {
    generationPattern: 1,
    resolution: 2,
    fps: 60,
    duration: 1,
    ratioWidth: 608,
    ratioHeight: 1080
  }
}, {
  headers: {
    'Authorization': 'Bearer YOUR_TOKEN',
    'Content-Type': 'application/json'
  }
});
```

## ğŸ”§ æ”¯æŒçš„å‚æ•°

### å¿…éœ€å‚æ•°
- `model`: æ¨¡å‹åç§° (å¦‚: "cogvideox")
- `prompt`: è§†é¢‘æè¿°æ–‡æœ¬

### å»æ°´å°å‚æ•°
- `label_watermark`: æ°´å°æ§åˆ¶ (0=æ— æ°´å°, 1=æœ‰æ°´å°)

### å¯é€‰å‚æ•°
- `image_url`: å‚è€ƒå›¾ç‰‡URL
- `video_style`: è§†é¢‘é£æ ¼ ("å¡é€š3D", "é»‘ç™½è€ç…§ç‰‡", "æ²¹ç”»", "ç”µå½±æ„Ÿ")
- `emotional_atmosphere`: æƒ…æ„Ÿæ°›å›´ ("æ¸©é¦¨å’Œè°", "ç”ŸåŠ¨æ´»æ³¼", "ç´§å¼ åˆºæ¿€", "å‡„å‡‰å¯‚å¯")
- `mirror_mode`: é•œåƒæ¨¡å¼ ("æ°´å¹³", "å‚ç›´", "æ¨è¿‘", "æ‹‰è¿œ")
- `audio_id`: éŸ³é¢‘ID

### é«˜çº§é€‰é¡¹ (options)
```json
{
  "generationPattern": 1,    // ç”Ÿæˆæ¨¡å¼
  "resolution": 2,           // åˆ†è¾¨ç‡
  "fps": 60,                // å¸§ç‡
  "duration": 1,            // æ—¶é•¿
  "ratioWidth": 608,        // å®½åº¦æ¯”ä¾‹ (çºµå‘9:16)
  "ratioHeight": 1080       // é«˜åº¦æ¯”ä¾‹ (çºµå‘9:16)
}
```

### ğŸ“ å¸¸ç”¨æ¯”ä¾‹è®¾ç½®
- **9:16 çºµå‘** (æ‰‹æœºç«–å±): `ratioWidth: 608, ratioHeight: 1080`
- **16:9 æ¨ªå‘** (ç”µè„‘æ¨ªå±): `ratioWidth: 1080, ratioHeight: 608`
- **1:1 æ­£æ–¹å½¢**: `ratioWidth: 720, ratioHeight: 720`
- **4:3 ä¼ ç»Ÿ**: `ratioWidth: 720, ratioHeight: 960`

## ğŸ¨ å®ç°åŸç†

### 1. è¯·æ±‚æ‹¦æˆªä¸ä¿®æ”¹
```typescript
// åœ¨å‘é€åˆ°GLM APIä¹‹å‰ï¼Œè‡ªåŠ¨æ·»åŠ å»æ°´å°å‚æ•°
const result = await axios.post(
  `https://chatglm.cn/chatglm/video-api/v1/chat`,
  {
    conversation_id: refConvId,
    prompt,
    source_list: sourceList.length > 0 ? sourceList : undefined,
    label_watermark: 0, // ğŸ”‘ å…³é”®å»æ°´å°å‚æ•°
    advanced_parameter_extra: {
      emotional_atmosphere: options.emotionalAtmosphere,
      mirror_mode: options.mirrorMode,
      video_style: options.videoStyle,
    },
    options: {
      generationPattern: 1,
      resolution: 2,
      fps: 60,
      duration: 1,
      ratioWidth: 608,
      ratioHeight: 1080
    }
  }
);
```

### 2. é»˜è®¤å»æ°´å°è®¾ç½®
- æ‰€æœ‰è§†é¢‘ç”Ÿæˆè¯·æ±‚é»˜è®¤è®¾ç½® `label_watermark: 0`
- ç”¨æˆ·å¯ä»¥é€šè¿‡å‚æ•°è¦†ç›–æ­¤è®¾ç½®
- ç¡®ä¿ç”Ÿæˆçš„è§†é¢‘æ²¡æœ‰å®˜æ–¹æ°´å°

## ğŸ§ª æµ‹è¯•éªŒè¯

### è¿è¡Œæµ‹è¯•è„šæœ¬
```bash
node test_watermark_removal.js
```

### å¯¹æ¯”æµ‹è¯•
1. **å¸¦æ°´å°**: `label_watermark: 1`
2. **æ— æ°´å°**: `label_watermark: 0`

## âœ… åŠŸèƒ½éªŒè¯æ¸…å•

- [ ] è§†é¢‘ç”ŸæˆæˆåŠŸ
- [ ] è¿”å›è§†é¢‘URL
- [ ] è§†é¢‘æ— æ°´å°
- [ ] æ”¯æŒè‡ªå®šä¹‰å‚æ•°
- [ ] é”™è¯¯å¤„ç†æ­£å¸¸

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **ä»ç„¶æœ‰æ°´å°**
   - æ£€æŸ¥ `label_watermark` æ˜¯å¦è®¾ç½®ä¸º 0
   - ç¡®è®¤è¯·æ±‚å‚æ•°æ ¼å¼æ­£ç¡®

2. **ç”Ÿæˆå¤±è´¥**
   - æ£€æŸ¥ Authorization token æ˜¯å¦æœ‰æ•ˆ
   - ç¡®è®¤ç½‘ç»œè¿æ¥æ­£å¸¸
   - æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—

3. **å‚æ•°é”™è¯¯**
   - éªŒè¯æ‰€æœ‰å¿…éœ€å‚æ•°éƒ½å·²æä¾›
   - æ£€æŸ¥å‚æ•°ç±»å‹å’Œæ ¼å¼

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **Token æœ‰æ•ˆæ€§**: ç¡®ä¿ä½¿ç”¨æœ‰æ•ˆçš„ GLM refresh token
2. **è¯·æ±‚é¢‘ç‡**: é¿å…è¿‡äºé¢‘ç¹çš„è¯·æ±‚
3. **èµ„æºæ¶ˆè€—**: è§†é¢‘ç”Ÿæˆéœ€è¦è¾ƒé•¿æ—¶é—´ï¼Œè¯·è€å¿ƒç­‰å¾…
4. **åˆè§„ä½¿ç”¨**: è¯·éµå®ˆç›¸å…³æœåŠ¡æ¡æ¬¾å’Œä½¿ç”¨è§„èŒƒ

## ğŸ‰ æˆåŠŸç¤ºä¾‹

æˆåŠŸçš„å»æ°´å°è§†é¢‘ç”Ÿæˆå“åº”ï¼š
```json
{
  "created": 1704067200,
  "data": [
    {
      "conversation_id": "65a1b2c3d4e5f6789012345",
      "cover_url": "https://example.com/cover.jpg",
      "video_url": "https://example.com/video.mp4",
      "video_duration": 5.0,
      "resolution": "1080x1920"
    }
  ]
}
```

ç”Ÿæˆçš„è§†é¢‘å°†ä¸åŒ…å«ä»»ä½•å®˜æ–¹æ°´å°ï¼ğŸŠ