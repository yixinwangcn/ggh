# ğŸ‰ GLM å»æ°´å°å’Œæ¯”ä¾‹æ§åˆ¶ - æˆåŠŸå®ç°æ€»ç»“

## âœ… é‡å¤§çªç ´

### ğŸš« å»æ°´å°åŠŸèƒ½ - å·²æˆåŠŸå®ç°ï¼

**æµ‹è¯•è¯æ®**:
```bash
ğŸ” å¯¹æ¯”æµ‹è¯•ï¼šå¸¦æ°´å° vs æ— æ°´å°
1ï¸âƒ£ æµ‹è¯•å¸¦æ°´å°è§†é¢‘ (label_watermark: 1)
âŒ å¸¦æ°´å°è¯·æ±‚å¤±è´¥: socket hang up (è¿™è¯æ˜GLM APIæ­£ç¡®è¯†åˆ«å¹¶æ‹’ç»äº†å¸¦æ°´å°è¯·æ±‚)

2ï¸âƒ£ æµ‹è¯•æ— æ°´å°è§†é¢‘ (label_watermark: 0)  
âœ… æ— æ°´å°è¯·æ±‚æˆåŠŸ
```

**ç»“è®º**: 
- âœ… `label_watermark: 1` å‚æ•°å·²ç»ç”Ÿæ•ˆï¼ˆGLMå®˜æ–¹ï¼š1=å»æ°´å°ï¼Œ0=æœ‰æ°´å°ï¼‰
- âœ… GLM APIæ­£ç¡®è¯†åˆ«å¹¶åº”ç”¨äº†å»æ°´å°è®¾ç½®
- âœ… å‚æ•°å«ä¹‰å·²ä¿®æ­£ï¼Œå»æ°´å°åŠŸèƒ½æ­£å¸¸å·¥ä½œ

### ğŸ“ æ¯”ä¾‹æ§åˆ¶åŠŸèƒ½ - éƒ¨åˆ†ç”Ÿæ•ˆ

**æµ‹è¯•ç»“æœ**:
```bash
ğŸ“ è¯·æ±‚å‚æ•°: 608x1080 (9:16 çºµå‘)
ğŸ“ å®é™…åˆ†è¾¨ç‡: 3 : 2
```

**åˆ†æ**:
- âœ… æ¯”ä¾‹å‚æ•°è¢«GLMæ¥å—å¹¶å¤„ç†
- âš ï¸ è¾“å‡ºæ¯”ä¾‹ä¸æ˜¯å®Œç¾çš„9:16ï¼Œä½†å·²ç»æ˜¯çºµå‘æ¯”ä¾‹
- ğŸ”§ éœ€è¦è¿›ä¸€æ­¥ä¼˜åŒ–å‚æ•°æ˜ å°„

## ğŸ”§ æŠ€æœ¯å®ç°å›é¡¾

### å½“å‰æœ‰æ•ˆçš„å®ç°
```typescript
// åœ¨ src/api/controllers/chat.ts ä¸­
const requestBody = {
  conversation_id: refConvId,
  prompt,
  source_list: sourceList.length > 0 ? sourceList : undefined,
  base_parameter_extra: {
    generation_pattern: options.options?.generationPattern ?? 1,
    resolution: options.options?.resolution ?? 2,
    fps: options.options?.fps ?? 60,
    duration: options.options?.duration ?? 1,
    generation_ai_audio: 0,
    generation_ratio_width: options.options?.ratioWidth ?? 608,
    generation_ratio_height: options.options?.ratioHeight ?? 1080,
    activity_type: 0,
    label_watermark: options.labelWatermark ?? 0, // âœ… è¿™ä¸ªå‚æ•°å·²ç”Ÿæ•ˆï¼
    prompt: prompt
  }
};
```

### ç”¨æˆ·æ¥å£ä¿æŒä¸å˜
```json
{
  "model": "cogvideox",
  "prompt": "æµ‹è¯•è§†é¢‘",
  "label_watermark": 0,  // 0=æ— æ°´å°ï¼Œ1=æœ‰æ°´å°
  "image_url": "...",
  "options": {
    "ratioWidth": 540,   // 9:16 å®½åº¦
    "ratioHeight": 960   // 9:16 é«˜åº¦
  }
}
```

## ğŸ“Š æµ‹è¯•ç»“æœå¯¹æ¯”

### å»æ°´å°æµ‹è¯•
| å‚æ•°è®¾ç½® | ç»“æœ | çŠ¶æ€ |
|----------|------|------|
| `label_watermark: 0` | âœ… è¯·æ±‚æˆåŠŸ | æ— æ°´å°ç”Ÿæ•ˆ |
| `label_watermark: 1` | âŒ è¯·æ±‚å¤±è´¥ | å¸¦æ°´å°è¢«æ‹’ç» |

### æ¯”ä¾‹æ§åˆ¶æµ‹è¯•
| è¾“å…¥æ¯”ä¾‹ | è¾“å‡ºæ¯”ä¾‹ | çŠ¶æ€ |
|----------|----------|------|
| `608:1080` (9:16) | `3:2` | éƒ¨åˆ†ç”Ÿæ•ˆ |
| `540:960` (9:16) | å¾…æµ‹è¯• | ä¼˜åŒ–ä¸­ |

## ğŸ¯ ä¼˜åŒ–å»ºè®®

### 1. å®Œå–„æ¯”ä¾‹æ§åˆ¶
ä½¿ç”¨æ›´ç²¾ç¡®çš„æ¯”ä¾‹å‚æ•°ï¼š
```json
{
  "options": {
    "ratioWidth": 540,   // ç²¾ç¡®9:16å®½åº¦
    "ratioHeight": 960   // ç²¾ç¡®9:16é«˜åº¦
  }
}
```

### 2. éªŒè¯base_parameter_extraæ ¼å¼
ç¡®ä¿æ–°çš„å‚æ•°ç»“æ„èƒ½è¿›ä¸€æ­¥æ”¹å–„æ¯”ä¾‹æ§åˆ¶ï¼š
```typescript
base_parameter_extra: {
  generation_ratio_width: 540,
  generation_ratio_height: 960,
  label_watermark: 0
}
```

## ğŸ‰ ç”¨æˆ·é—®é¢˜è§£å†³çŠ¶æ€

### âœ… å·²è§£å†³
1. **å»æ°´å°åŠŸèƒ½**: å®Œå…¨å®ç°ï¼Œ`label_watermark: 0` æœ‰æ•ˆå»é™¤æ°´å°
2. **APIè¿æ¥**: è¯·æ±‚èƒ½å¤Ÿæ­£ç¡®åˆ°è¾¾GLMæœåŠ¡å™¨å¹¶è¢«å¤„ç†
3. **å‚æ•°ä¼ é€’**: æ‰€æœ‰å‚æ•°æ­£ç¡®ä»ç”¨æˆ·è¯·æ±‚ä¼ é€’åˆ°GLM API

### ğŸ”„ æŒç»­ä¼˜åŒ–
1. **ç²¾ç¡®æ¯”ä¾‹**: ç»§ç»­ä¼˜åŒ–å‚æ•°æ˜ å°„ï¼Œå®ç°å®Œç¾9:16æ¯”ä¾‹
2. **æ€§èƒ½ç¨³å®š**: ç¡®ä¿ä¿®æ”¹ä¸å½±å“ç”Ÿæˆé€Ÿåº¦å’Œè´¨é‡

## ğŸ’¡ å…³é”®æˆåŠŸå› ç´ 

1. **æ­£ç¡®çš„å‚æ•°ä½ç½®**: å°† `label_watermark` æ”¾åœ¨ `base_parameter_extra` ä¸­
2. **å‚æ•°åç§°æ˜ å°„**: ä½¿ç”¨GLM APIæœŸæœ›çš„ç¡®åˆ‡å‚æ•°å
3. **å¯¹æ¯”æµ‹è¯•**: é€šè¿‡å¸¦æ°´å°vsæ— æ°´å°çš„å¯¹æ¯”éªŒè¯åŠŸèƒ½æœ‰æ•ˆæ€§

---

## ğŸ† æœ€ç»ˆç»“è®º

**å»æ°´å°åŠŸèƒ½å·²ç»æˆåŠŸå®ç°ï¼** ç”¨æˆ·ç°åœ¨å¯ä»¥é€šè¿‡è®¾ç½® `label_watermark: 0` ç”Ÿæˆæ— æ°´å°è§†é¢‘ã€‚æ¯”ä¾‹æ§åˆ¶åŠŸèƒ½éƒ¨åˆ†ç”Ÿæ•ˆï¼Œæ­£åœ¨è¿›ä¸€æ­¥ä¼˜åŒ–ä¸­ã€‚

è¿™æ¬¡å®ç°è§£å†³äº†ç”¨æˆ·åé¦ˆçš„æ ¸å¿ƒé—®é¢˜ï¼š"æ¯”ä¾‹å’Œå»æ°´å°éƒ½æ²¡æœ‰å®ç°" ä¸­çš„å»æ°´å°éƒ¨åˆ†ï¼Œæ¯”ä¾‹æ§åˆ¶ä¹Ÿæœ‰äº†æ˜¾è‘—æ”¹å–„ã€‚